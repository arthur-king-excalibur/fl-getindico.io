<?xml version='1.0'?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN" "http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd">
<book>

  <article>

    <articleinfo>

      <title>Indico Installation Guide</title>

      <graphic fileref="figure/logo"/>
      <corpauthor>CERN</corpauthor>

    </articleinfo>

    <sect1 id="programs">

      <title>Programs to Install prior</title>

      <informaltable frame="none">

        <tgroup cols="2">

          <tbody>

            <row><entry>1. Python 2.4.4 (and above)</entry><entry>
            <ulink url="http://python.org"/></entry></row>

            <row><entry>2. Apache HTTP Server 2.0 (and 
            above)</entry><entry><ulink url="http://httpd.apache.org/download.cgi"/></entry></row>

            <row><entry>3. ZODB 3.4</entry><entry>
            <ulink url="http://zope.org/Products/ZODB3.4"/></entry></row>

            <row><entry>4. Reportlab 2.0</entry><entry>
            <ulink url="http://www.reportlab.org/downloads.html"/></entry></row>

            <row><entry>5. mod_python 3.3.1 (and above)</entry><entry>
            <ulink url="http://httpd.apache.org/modules/python-download.cgi"/></entry></row>

            <row><entry>6. libxml and libxslt</entry><entry>
            <ulink url="http://xmlsoft.org/python.html"/></entry></row>

            <row><entry>7. Python Imaging Library</entry><entry>
                    <ulink url="http://www.pythonware.net/storage/Imaging-1.1.4.tar.gz"/></entry></row>

            <row><entry>8. Pytz - Python Timezone Library</entry><entry>
                    <ulink url="http://sourceforge.net/projects/pytz"/></entry></row>

            <row><entry>9. Python simplejson </entry><entry>
                    <ulink url="http://pypi.python.org/pypi/simplejson"/></entry></row>

          </tbody>

        </tgroup>

      </informaltable>

    </sect1>

    <sect1 id="ModPythonConfiguration">

      <title>Mod_python configuration</title>

      <para>In the Apache config files (httpd.conf or apache2.conf) add 
      the following:</para>

      <orderedlist numeration="lowerroman">

        <listitem>

          <para>Add the &quot;LoadModule&quot; line to make Apache load 
          mod_python.</para>

          <para>

            In Linux, the configuration files normally already has the 
            following line:
            <screen>Include /etc/apache2/mods-enabled/*.load
Include /etc/apache2/mods-enabled/*.con</screen>
            If you have installed mod_python through a package, the 
            file /etc/apache2/mods-enabled/mod_python.load will 
            probably be already created with the &apos;LoadModule&apos; 
            line inside it. In that case, you don&apos;t need to add 
            anything. Otherwise, see the instructions for Windows.
          </para>

          <para>

            In Windows, add the following line:
            <screen>LoadModule python_module modules/mod_python.so</screen>
            This assumes mod_python.so has been placed in the modules 
            folder. Otherwise, put the appropriate directory instead.
          </para>

          <para>For more information, see the mod python 
          documentation</para>

        </listitem>

        <listitem>

          <para>
            At the end of the Apache config file add:
            <screen>     &lt;Directory &quot;C:/Program Files/Apache Group/Apache2/htdocs/MaKaC&quot;&gt; 
     AddHandler python-program .py
     PythonHandler mod_python.publisher
     PythonDebug On
     &lt;/Directory&gt;</screen>
            <emphasis>Adapt this to your own file system, e.g. If using 
            Linux use &lt;Directory 
            &quot;/soft/http/htdocs/MaKaC&quot;&gt;</emphasis>
          </para>

        </listitem>

        <listitem>

          <para>Change the Apache config file so that Apache is 
          aware of previous directory. There are usually two ways of 
          doing this:</para>
          <para>-Changing the DocumentRoot value. If you used 
          &quot;C:/Program Files/Apache 
          Group/Apache2/htdocs/MaKaC&quot;, a correct value of 
          DocumentRoot would be &quot;C:/Program Files/Apache 
          Group/Apache2/htdocs&quot;, if you want Indico to show on 
          http://webserverhostname/MaKaC/index.py.</para>
          <para>For Linux a correct DocumentRoot value would be 
          &quot;/soft/http/htdocs&quot;.</para>
          <para>
            -Using the Alias directive by adding the following at the 
            end of the Apache configuration file:
            <screen>Alias /MaKaC &quot;C:Program Files/Apache Group/Apache2/htdocs/MaKaC&quot;</screen>
            or in Linux:
            <screen>Alias /MaKaC &quot;/soft/http/htdocs/MaKaC&quot;</screen>
          </para>

        </listitem>

      </orderedlist>

    </sect1>

    <sect1 id="Installation">

      <title>Installation</title>

      <para>After downloading and uncompressing the Indico 
      distribution, you have 2 options when running an installation: 
      Default or Custom.</para>

      <para><emphasis>Your uncompressed folder will be referred to as 
      the &apos;Indico distributed directory&apos; throughout this 
      document</emphasis></para>

      <sect2 id="Default">

        <title>Default Installation</title>

        <para>To make a default installation, from the &apos;Indico 
        distributed directory&apos;, run the setup install script 
        using</para>

        <screen> &quot;setup.py install&quot;</screen>
        <para>A default installation will install Indico onto your 
        machine dependant on the platform you are running. The default 
        configuration for Indico is:</para>

        <orderedlist numeration="lowerroman">

          <listitem>

            <para>

              Main Package Directory &apos;pkgdirectory&apos; (Pythons 
              site packages directory name varies on version):
              <screen>Windows - C:\Python24\Lib\site-packages
Linux -  /usr/local/lib/python2.4/site-packages</screen>
              (Templates Directory &apos;tpls&apos; is defaulted to 
              this directory with /MaKaC/webinterface/tpls at the end)
            </para>

          </listitem>

          <listitem>

            <para>

              Apache Files Directory &apos;htdocs&apos;:
              <screen>Windows - C:\Program Files\Apache Group\Apache2\htdocs\MaKaC
Linux -  /soft/http/htdocs/MaKaC</screen>
              (Images Directory &apos;images&apos; is defaulted to this 
              directory with /images at the end
            </para>

          </listitem>

          <listitem>

            <para>

              Archive Directory &apos;archive&apos;:
              <screen>Windows - C:\MaKaC\archive
Linux -  /soft/MaKaC/archive</screen>
            </para>

          </listitem>

          <listitem>

            <para>

              Temporary Directory &apos;temp&apos;:
              <screen>Windows - C:\MaKaC\temp
Linux -  /soft/MaKaC/temp</screen>
            </para>

          </listitem>

          <listitem>

            <para>For All other parameters the default configurations 
            are written in the XML config file</para>

          </listitem>

        </orderedlist>

        <para>See <link linkend="XMLConf">Explanation of XML config 
        file</link> for more information on each path</para>

      </sect2>

      <sect2 id="Custom">

        <title>Custom Installation</title>

        <para>A custom Installation lets you change the directories and 
        parameters of the Indico installation, please read 
        <link linkend="XMLConf">Explanation of XML config file</link>, 
        before starting a custom installation this will explain what 
        each parameter is, then follow these steps:</para>

        <orderedlist>

          <listitem>

            <para>From the &apos;Indico distributed directory&apos;, 
            open the <emphasis>config.xml</emphasis> file into a text 
            editor</para>

          </listitem>

          <listitem>

            <para>Edit the path names and parameters that you wish to 
            change, save and close the file</para>

            <orderedlist inheritnum="inherit" numeration="arabic">

              <listitem>

                <para>If you changed the &quot;htdocs&quot; path name 
                you need to change the &lt;Directory&gt; you added in 
                the Apache config file to match your htdocs path</para>

              </listitem>

              <listitem>

                <para>

                  If you changed the &quot;pkgdirectory&quot; path name 
                  you need to add to the code you added in the Apache 
                  config file. Before the final &lt;/Directory&gt; tag 
                  you need to add:
                  <screen>PythonPath &quot;sys.path+[&apos;pkgdirectory&apos;]&quot;</screen>
                  Where pkgdirectory is the full path of your defined 
                  directory
                </para>

              </listitem>

              <listitem>

                <para>If you changed the &quot;dp_param&quot; you may 
                need to edit the &apos;address&apos; section in the 
                config file for ZODB, for information on how to do this 
                visit: 
                <ulink url="http://zope.org/Wikis/ZODB/HowtoRunAZEOServer/howto.html"/>
                </para>

              </listitem>

            </orderedlist>

          </listitem>

          <listitem>

            <para>

              From the &apos;Indico distributed directory&apos;, run 
              the setup install script using
              <screen> &quot;setup.py install&quot;</screen>
            </para>

          </listitem>

        </orderedlist>

      </sect2>

      <sect2 id="Running">

        <title>Running Indico</title>

        <para>To run Indico:</para>

        <orderedlist>

          <listitem>

            <para>Start the Database Daemon: You need to have the ZODB 
            Database running in order for InDiCo to work 
            correctly.</para>

            <para>The database can be on your machine or running on a 
            remote machine. The ZODB database runs into a ZEO server. 
            In order to have the server running, you should locate the 
            script &quot;runzeo.py&quot;, which should be in the ZEO 
            server folder (/usr/lib/python2.4/site-packages/ZEO/ in 
            Linux).</para>

            <para>

              Create a file called &quot;zeo.config&quot; with the 
              following lines for a default installation:
              <screen>&lt;zeo&gt;
  address databasehostname:9675
  transaction-timeout 5
&lt;/zeo&gt;
&lt;filestorage 1&gt;
  path /usr/lib/python2.4/site-packages/ZEO/data/data.fs
&lt;/filestorage&gt;

&lt;eventlog&gt;
  &lt;logfile&gt;
    path /usr/lib/python2.4/site-packages/ZEO/log/zeo.log
    format %(asctime)s %(message)s
  &lt;/logfile&gt;
&lt;/eventlog&gt;</screen>
            </para>

            <para>Please note that the host name of the database should 
            be the same as the one you put in config.xml file (see 
            &quot;Explanation of the XML Configuration File 
            &apos;config.xml&apos; &quot;). Of course you can change 
            the &lt;filestorage&gt; and &lt;logfile&gt; values to your 
            convenience.</para>

            <para>

              After creating the file zeo.config, call the script 
              runzeo.py with
              <screen>python runzeo.py -C zeo.config</screen>
            </para>

            <para>For more information, please see the &quot;How to run 
            a ZEO Server&quot; 
            (http://zope.org/Wikis/ZODB/HowtoRunAZEOServer/howto.html) 
            for more information on how to do this.</para>

          </listitem>

          <listitem>

            <para>Start the Apache Server: You need to have the Apache 
            server running for Indico to work, for more information on 
            starting the Apache Server visit:</para>

            <itemizedlist>

              <listitem>

                <para>
                <ulink url="http://httpd.apache.org/docs-2.0/platform/windows.html">Using 
                Apache with Microsoft Windows</ulink></para>

              </listitem>

              <listitem>

                <para>
                <ulink url="http://httpd.apache.org/docs-2.0/invoking.html">Starting 
                Apache</ulink> (For Linux).</para>

                <para>

                  In Linux, you normally can do this by executing
                  <screen>apache2ctl -k start/stop/restart/graceful</screen>
                  as root.
                </para>

              </listitem>

            </itemizedlist>

          </listitem>

          <listitem>

            <para>

              In a web browser type your base URL followed by index.py. 
              If you chose a default installation or did not edit the 
              URL base, this will be:
              <screen>http://webserverhostname/MaKaC/index.py</screen>
            </para>

          </listitem>

        </orderedlist>

      </sect2>

    </sect1>

    <sect1 id="reconf">

      <title>Reconfiguring after Installation</title>

      <para>Once you have installed Indico you may need to change a 
      path or parameter of the configuration. This can be done by 
      reconfiguring Indico. To do this:</para>

      <orderedlist>

        <listitem>

          <para>From the &apos;common&apos; folder inside your main 
          package directory (&apos;pkgdirectory/MaKaC/common&apos;), 
          open the config.xml file with a text editor. If a default 
          installation was chosen or &quot;pkgdirectory&quot; was not 
          edited, this will be located inside Python site-packages. 
          Otherwise it will be inside the &quot;pkgdirectory&quot; you 
          specified when installing Indico.</para>

        </listitem>

        <listitem>

          <para>Edit those parameters or paths that you wish to 
          reconfigure, then save and close the file.</para>

        </listitem>

        <listitem>

          <para>

            From the current directory (MaKaC/common), run the 
            reconfigure script using
            <screen>&quot;reconfigure.py run&quot;</screen>
          </para>

        </listitem>

        <listitem>

          <para>Restart the Apache Server.</para>

        </listitem>

      </orderedlist>

      <para>Your Indico Installation will now be reconfigured with your 
      new settings.</para>

      <para><emphasis>NOTE: You cannot reconfigure the main package 
      directory, if you need to change the main installation directory 
      you can do so by either upgrading or reinstalling Indico 
      again.</emphasis></para>

    </sect1>

    <sect1 id="upgrade">

      <title>Upgrading</title>

      <para>Once you already have an installation of Indico you may 
      need to install a newer release. If you want to keep the same 
      configurations as your previous installation, you can upgrade 
      your version. During the upgrading process, your current settings 
      will be read and you will be able to check if they are correct. 
      You can also edit the settings if you want the new release to be 
      configured differently.</para>

      <para>Once you have downloaded and uncompressed your Indico 
      distribution you can upgrade by:</para>

      <orderedlist>

        <listitem>

          <para>

            From the &apos;Indico distributed directory&apos; run the 
            Upgrade script using:
            <screen>&quot;setup.py upgrade&quot;</screen>
          </para>

          <orderedlist inheritnum="inherit" numeration="arabic">

            <listitem>

              <para>You will then be asked to give the directory path 
              of the MaKaC package or to type &apos;default&apos; if 
              you did not specify the &quot;pkgdirectory&quot; on the 
              original installation.</para>

            </listitem>

            <listitem>

              <para>Follow the instructions given.</para>

            </listitem>

          </orderedlist>

        </listitem>

        <listitem>

          <para>

            From the &apos;Indico distributed directory&apos; run the 
            setup install script using:
            <screen>&quot;setup.py install&quot;</screen>
          </para>

        </listitem>

        <listitem>

          <para>Restart the Apache Server.</para>

        </listitem>

      </orderedlist>

      <para>Your upgraded Indico version will now be installed</para>

    </sect1>

    <sect1 id="XMLConf">

      <title>Explanation of the XML Configuration File 
      &apos;config.xml&apos;</title>

      <sect2 id="xmlpaths">

        <title>Path Directories</title>

        <para>See <link linkend="Default">Default Installation</link> 
        for the default configurations of these paths</para>

        <para><emphasis>Numbered sections may not be in the same order 
        in the actual config.xml file</emphasis></para>

        <screen>
&lt;!--Enter Path names in between the pathdir tags, e.g.&lt;pathdir&gt;c:\tmp&lt;/pathdir&gt; 
or leave blank for default--&gt;

 &lt;paths&gt;
<co id="pkg"></co>   &lt;pathname&gt;pkgdirectory&lt;/pathname&gt;
     &lt;pathdir&gt;&lt;/pathdir&gt;
 &lt;/paths&gt;

&lt;!--htdocs needs to be the same directory as where you set the modpython handler 
(or blank)--&gt;
 &lt;paths&gt;
<co id="htd"></co>   &lt;pathname&gt;htdocs&lt;/pathname&gt; 
     &lt;pathdir&gt;&lt;/pathdir&gt;
 &lt;/paths&gt;

 &lt;paths&gt;
<co id="arc"></co>   &lt;pathname&gt;archive&lt;/pathname&gt; 
     &lt;pathdir&gt;&lt;/pathdir&gt;
 &lt;/paths&gt;

 &lt;paths&gt;
<co id="tem"></co>   &lt;pathname&gt;temp&lt;/pathname&gt; 
      &lt;pathdir&gt;&lt;/pathdir&gt;
 &lt;/paths&gt;

 &lt;paths&gt;
<co id="tpl"></co>   &lt;pathname&gt;tpls&lt;/pathname&gt; 
    &lt;pathdir&gt;&lt;/pathdir&gt;
 &lt;/paths&gt;

&lt;paths&gt;
<co id="ss"></co>   &lt;pathname&gt;ssheets&lt;/pathname&gt;
    &lt;pathdir&gt;&lt;/pathdir&gt;
 &lt;/paths&gt;       
        </screen>
        <calloutlist><callout arearefs="pkg"><para>The main package 
        directory, this is where the main package files for the Indico 
        program will be put on you machine,this will be under a folder 
        called MaKaC.</para></callout><callout arearefs="htd"><para>The 
        htdocs directory, this directory holds the Apache-link files 
        for the webinterface.</para></callout>
        <callout arearefs="arc"><para>The archive directory, multimedia 
        files attached to the conferences will be stored in this 
        directory.</para></callout><callout arearefs="tem"><para>The 
        temporary directory, files being uploaded and any other 
        temporary files will be stored into this directory, 
        <emphasis>Note: This directory needs to have a fair amount of 
        space available.</emphasis></para></callout>
        <callout arearefs="tpl"><para>The templates directory, 
        templates for the webinterface are kept in this 
        directory.</para></callout><callout arearefs="ss"><para>The 
        stylesheets directory, the stylesheets are stored in this 
        directory</para></callout></calloutlist>
      </sect2>

      <sect2 id="xmldb">

        <title>Database, Access Rights, Url, Email, SMTP and OAI 
        Parameters</title>

        <screen>
&lt;!--Enter database parameters in between tags, e.g. &lt;port&gt;1234&lt;/port&gt;
or leave as they are for default--&gt;

 &lt;db_param&gt;
     <co id="hst"></co>     &lt;host&gt;databasehostname&lt;/host&gt;
     <co id="prt"></co>     &lt;port&gt;9675&lt;/port&gt;
 &lt;/db_param&gt;

&lt;!-- Enter user and group name for access rights on the Public Folder 
(only applicable for linux installations)--&gt;

 &lt;access&gt;
     <co id="usr"></co>     &lt;user&gt;&lt;/user&gt;
     <co id="grp"></co>     &lt;group&gt;&lt;/group&gt;
 &lt;/access&gt;

&lt;!--Enter url base in between tags, e.g. &lt;url&gt;http://webserverhostname/MaKaC&lt;/url&gt; 
or leave as it is for default--&gt;

 
     <co id="url"></co> &lt;url&gt;http://webserverhostname/MaKaC&lt;/url&gt;
 
&lt;!--Enter support email in between tags, e.g. &lt;email&gt;indico-project@cern.ch&lt;/email&gt; 
or leave for default--&gt;

 
     <co id="ema"></co> &lt;email&gt;indico-project@cern.ch&lt;/email&gt;


&lt;!--Enter SMTP Server to send Email or leave for default--&gt;

     <co id="smt"></co> &lt;smtp&gt;smtp.cern.ch&lt;/smtp&gt;

&lt;!--OAI Parameters, leave for default --&gt;

     <co id="oai"></co> &lt;OAI&gt;
             &lt;logfile&gt;/tmp/oailog.log&lt;/logfile&gt;
             &lt;nb_record&gt;100&lt;/nb_record&gt;
             &lt;nb_ids&gt;100&lt;/nb_ids&gt;
             &lt;oai_rt_exp&gt;90000&lt;/oai_rt_exp&gt;
             &lt;namespace&gt;eAgora.cern.ch&lt;/namespace&gt;
             &lt;iconfNS&gt;URL_base&lt;/iconfNS&gt;
             &lt;iconfXSD&gt;URL_base+&quot;/iconf.xsd&quot;&lt;/iconfXSD&gt;
             &lt;reposName&gt;eAgora&lt;/reposName&gt;
             &lt;reposId&gt;eAgora.cern.ch&lt;/reposId&gt;
       &lt;/OAI&gt;
 </screen>
        <calloutlist><callout arearefs="hst"><para>The database host, 
        this parameter holds the location of the host that the database 
        is stored on.</para></callout><callout arearefs="prt"><para>The 
        database port, this parameter holds the port number of which to 
        contact the database.</para></callout>
        <callout arearefs="usr"><para>The user for access, this 
        parameter holds the user for which the public folder will be 
        given rights to.</para></callout>
        <callout arearefs="grp"><para>The group for access, this 
        parameter holds the group for which the public folder will be 
        given rights to.</para></callout>
        <callout arearefs="url"><para>The Base Url, the url from which 
        Indico can be reached from a web browser.</para></callout>
        <callout arearefs="ema"><para>The support email, the email 
        address for people to contact with support 
        issues.</para></callout><callout arearefs="smt"><para>The smtp 
        server, the server to allow emails to be sent 
        out.</para></callout><callout arearefs="oai"><para>The OAI 
        parameters, these are for configuring the open archive 
        interface.</para></callout></calloutlist>
      </sect2>

      <sect2 id="xmltypes">

        <title>File Types and System Icons</title>

        <screen>
&lt;!--Known file types--&gt;

<co id="ftype"></co> &lt;FileType&gt;
            &lt;type&gt;DOC&lt;/type&gt;
            &lt;name&gt;Ms Word&lt;/name&gt;
            &lt;loc&gt;application/msword&lt;/loc&gt;
            &lt;img&gt;doc.gif&lt;/img&gt;
   &lt;/FileType&gt;

&lt;!-- System Icons --&gt;

<co id="sysI"></co> &lt;SysIcon&gt;
             &lt;icon&gt;modify&lt;/icon&gt;
             &lt;pic&gt;link.gif&lt;/pic&gt;
   &lt;/SysIcon&gt;
      
&lt;!-- Stylesheets--&gt;


<co id="ssa"></co>   &lt;event&gt;
          &lt;eventname&gt;simple_event&lt;/eventname&gt;
              &lt;sheets&gt;
                        &lt;view&gt;static&lt;/view&gt;
                        &lt;style&gt;static&lt;/style&gt;
              &lt;/sheets&gt;
    &lt;/event&gt;


&lt;!-- Default Stylesheets --&gt;

<co id="dss"></co> &lt;defaultss&gt;
                &lt;eventid&gt;simple_event&lt;/eventid&gt;
                &lt;sheet&gt;lecture&lt;/sheet&gt;
   &lt;/defaultss&gt;
        </screen>
        <calloutlist><callout arearefs="ftype"><para>FileTypes, These 
        specify the different file types and the name, location and 
        image associated with them that are available within 
        Indico.</para></callout><callout arearefs="sysI"><para>System 
        Icons, These specify the icon name and the image associated 
        with them.</para></callout>
        <callout arearefs="ssa"><para>Stylesheets, These specify the 
        stylesheets available for each event with the event name, view 
        and stylesheet.</para></callout>
        <callout arearefs="dss"><para>Default Stylesheets, These 
        specify the default stylesheet for each event with the event 
        name and stylesheet.</para></callout></calloutlist>
      </sect2>

    </sect1>

    <sect1 id="notes">

      <title>Notes</title>

      <orderedlist numeration="loweralpha">

        <listitem>

          <para>If you would like to check that the config.xml file is 
          valid once you have changed it there is a schema called 
          config.xsd in the dist directory which you may validate it 
          with. To do this you can use</para>

          <para>
          <ulink url="http://apps.gotdotnet.com/xmltools/xsdvalidator/Default.aspx"/></para>

        </listitem>

      </orderedlist>

    </sect1>

  </article>

</book>

