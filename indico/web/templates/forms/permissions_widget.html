{% extends 'forms/base_widget.html' %}

{% block html %}
    <h3>Permissions</h3>
    <div id="permissions-widget-{{ field.id }}" class="js-permissions-widget">
        <input type="hidden" value='{{ field._value() }}' name="permissions">
        <ul class="permissions-widget-list"></ul>
        <div class="toolbars">
            <div class="toolbar">
                <a class="i-button icon-plus highlight arrow" id="permissions-add-entry-menu-target">
                    {%- trans %}Add entry{% endtrans -%}
                </a>
                <div id="permissions-add-entry-menu">
                    <div class="flexcol f-a-start">
                        <a href="#" class="i-button borderless js-add-user-group">
                            {%- trans %}User / Group{% endtrans -%}
                        </a>
                        <a href="#" class="i-button borderless arrow js-dropdown" data-toggle="dropdown">
                            {%- trans %}Role{% endtrans -%}
                        </a>
                        <ul class="dropdown entry-role-dropdown" data-items='{{ field.roles|tojson }}'></ul>
                        <a href="#" class="i-button borderless arrow js-dropdown" data-toggle="dropdown">
                            {%- trans %}IP Network{% endtrans -%}
                        </a>
                        <ul class="dropdown entry-ip-network-dropdown" data-items='{{ field.ip_networks|tojson }}'></ul>
                    </div>
                </div>
            </div>
            <div class="toolbar">
                <a href="{{ url_for('event_roles.manage', field.event) }}"
                   class="i-button icon-medal text-color borderless">
                    {%- trans %}Manage roles{% endtrans -%}
                </a>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascript %}
    <script>
        $('#permissions-widget-{{ field.id }}').permissionswidget({
            event_id: {{ field.event.id }}
        });
    </script>
{% endblock %}
