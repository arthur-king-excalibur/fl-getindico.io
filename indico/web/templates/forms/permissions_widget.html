{% extends 'forms/base_widget.html' %}

{% block html %}
    <h3>Permissions</h3>
    <div id="permissions-widget-{{ field.id }}" class="permissions-widget">
        <input type="hidden" value='{{ field._value() }}' name="permissions">
        <ul class="permissions-widget-list"></ul>
        <div class="toolbars">
            <div class="toolbar">
                <div class="group">
                    <a href="#" class="i-button label text-color outline add-entry-decoration icon-plus"></a>
                    <a class="i-button js-add-user-group">{% trans %}User / Group{% endtrans %}</a>
                    {% if field.roles %}
                        <a class="i-button arrow js-dropdown" data-toggle="dropdown">{% trans %}Role{% endtrans %}</a>
                        <ul class="dropdown entry-role-dropdown" data-items='{{ field.roles|tojson }}'></ul>
                    {% endif %}
                    {% if field.ip_networks %}
                        <a class="i-button arrow js-dropdown" data-toggle="dropdown">
                            {%- trans %}IP Network{% endtrans -%}
                        </a>
                        <ul class="dropdown entry-ip-network-dropdown" data-items='{{ field.ip_networks|tojson }}'></ul>
                    {% endif %}
                </div>
            </div>
            <div class="toolbar">
                <a href="{{ url_for('event_roles.manage', field.event) }}"
                   class="i-button icon-medal text-color borderless">
                    {%- trans %}Manage roles{% endtrans -%}
                </a>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascript %}
    <script>
        $('#permissions-widget-{{ field.id }}').permissionswidget({
            event_id: {{ field.event.id }}
        });
    </script>
{% endblock %}
