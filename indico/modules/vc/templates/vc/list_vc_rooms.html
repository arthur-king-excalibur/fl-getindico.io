{% macro render_vc_room(event_vc_room, event) -%}
    {% set vc_room = event_vc_room.vc_room %}
    <div class="event-service-row">
        <div class="event-service-row-collapsed clearfix">
            <div class="event-service-info event-service-row-toggle left">
                <!-- TODO: Change icon to plugin specific -->
                <img src="/images/video_Vidyo.png" border="0" alt="locked"/>
                <span class="event-service-title">{{ vc_room.name }}</span>
            </div>
            {{ vc_room.plugin.render_event_buttons(vc_room, event_vc_room) | safe }}
        </div>
        <div class="event-service-details">
            {{ vc_room.plugin.render_info_box(vc_room, event_vc_room, event) | safe }}
        </div>
        <a class="trigger icon-expand" title="{% trans %}More info{% endtrans %}"></a>
    </div>
{%- endmacro %}

{% macro render_vc_rooms_list(event, event_vc_rooms, linked_to=None) -%}
    <div>
        {% if linked_to %}
            {% if linked_to.event %}
                <div class="groupTitleNoBorder collaborationDisplayTitle event-service-association-title">
                    {{ event.getTitle() }}<span class="event-service-association-subtitle">{% trans %}Event{% endtrans %}</span>
                </div>
                {% for event_vc_room in linked_to.event[event] %}
                    {{ render_vc_room(event_vc_room, event) }}
                {% endfor %}
            {% endif %}
            {% if linked_to.contribution %}
                {% for contrib, event_vc_rooms in linked_to.contribution.iteritems() %}
                    <div class="groupTitleNoBorder collaborationDisplayTitle event-service-association-title">
                        {{ contrib.getTitle() }}<span class="event-service-association-subtitle">{% trans %}Contribution{% endtrans %}</span>
                    </div>
                    {% for event_vc_room in event_vc_rooms %}
                        {{ render_vc_room(event_vc_room, event) }}
                    {% endfor %}
                {% endfor %}
            {% endif %}
            {% if linked_to.block %}
                {% for block, event_vc_rooms in linked_to.block.iteritems() %}
                    <div class="groupTitleNoBorder collaborationDisplayTitle event-service-association-title">
                        {{ block.getFullTitle() }}<span class="event-service-association-subtitle">{% trans %}Session{% endtrans %}</span>
                    </div>
                    {% for event_vc_room in event_vc_rooms %}
                        {{ render_vc_room(event_vc_room, event) }}
                    {% endfor %}
                {% endfor %}
            {% endif %}
        {% else %}
            {% for event_vc_room in event_vc_rooms %}
                {{ render_vc_room(event_vc_room, event) }}
            {% endfor %}
        {% endif %}
    </div>
    <script>
        $('.clip_button').one('mouseover', function() {
            // Snippet to copy links to the clipboard
            var client = new ZeroClipboard($(this));

            client.on('ready', function(event) {
                client.on('copy', function(event) {
                    event.clipboardData.setData('text/plain', event.target.getAttribute('data-link'));
                } );
                client.on('aftercopy', function(event) {
                    $(event.target).parent().siblings('.button-info-message').show().fadeOut(2000);
                } );
            } );

            client.on('error', function(event) {
                ZeroClipboard.destroy();
            } );
        });
    </script>
{%- endmacro %}
