{% extends 'events/surveys/management/_survey_base.html' %}
{% from 'events/surveys/management/_questionnaire_preview.html' import render_questionnaire_preview %}

{% block content %}
    <div class="flashed-messages"></div>

    <div class="i-box titled">
        <div class="i-box-header">
            <div class="i-box-title">
                {% trans %}Questionnaire{% endtrans %}
            </div>
            <div class="i-box-buttons toolbar right">
                <div class="group">
                    <a href="#" data-href="{{ url_for('.add_question', survey, type='static_text') }}"
                       class="i-button js-question-dialog"
                       data-title="{% trans %}Add section{% endtrans %}">
                        {% trans %}Add new section{% endtrans %}
                    </a>
                    <a class="i-button arrow js-add-question-dropdown" data-toggle="dropdown">{% trans %}Add new question{% endtrans %}</a>
                    <ul class="dropdown">
                        {% for field_type in field_types.values()|sort(attribute='friendly_name') if not field_type.is_section %}
                            <li>
                                <a href="#" data-href="{{ url_for('.add_question', survey, type=field_type.name) }}"
                                   data-title="{% trans %}Add question{% endtrans %}"
                                   class="js-question-dialog">
                                    {{ field_type.friendly_name }}
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
        <div id="survey-questionnaire-preview" data-sort-url="{{ url_for('.sort_questions', survey) }}">
            {{ render_questionnaire_preview(survey, preview_form) }}
        </div>
    </div>
    <div class="toolbar right">
        <a href="{{ url_for('.manage_survey', survey) }}" class="i-button big">
            {% trans %}Back{% endtrans %}
        </a>
    </div>

    <script>
        setupQuestionSorter();
    </script>
{% endblock %}
