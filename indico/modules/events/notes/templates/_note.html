{% macro render_note(note, hidden=true, for_event=none) %}
    {% if for_event %}
        <div class="toolbar thin" style="text-align: right">
            {{ render_event_note_buttons(event=for_event, note=note, hidden=hidden) }}
        </div>
    {% endif %}
    {% if note %}
        <div class="note-area-wrapper">
            <div class="note-area {{ _togglable_classes(hidden) }}">
                <div class="padded-box">
                    <div class="padded-box-pad icon-file"></div>
                    <div class="padded-box-content">
                        <a href="{{ url_for('event_notes.view', note) }}" target="_blank"
                           class="permalink icon-link" title="{% trans %}Permanent link{% endtrans %}"></a>
                        <div class="note-text">
                            {{ note.html|safe }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    {% endif %}
{% endmacro %}


{% macro render_event_note_buttons(event, note=none, hidden=true) %}
    {% if note %}
        {{ render_toggle_button(note=note, note_is_hidden=hidden) }}
        <div class="group">
            <button class="i-button icon-edit js-note-editor" title="{% trans %}Edit{% endtrans %}"
                    data-href="{{ url_for('event_notes.edit', event) }}"></button>
        </div>
        <div class="group">
            <button class="i-button icon-remove js-confirm-warning" title="{% trans %}Delete{% endtrans %}"
                    data-href="{{ url_for('event_notes.delete', event) }}" data-method="POST"
                    data-title="{% trans %}Delete minutes?{% endtrans %}"
                    data-confirm="{% trans %}Do you want to delete the minutes of this event{% endtrans %}"></button>
        </div>
    {% else %}
        <div class="group">
            <button class="i-button highlight icon-plus js-note-editor"
                    data-href="{{ url_for('event_notes.edit', event) }}">
                {% trans %}Add minutes{% endtrans %}
            </button>
        </div>
        <div class="group">
            <button class="i-button icon-stack js-note-editor"
                    data-href="{{ url_for('event_notes.compile', event) }}">
                {% trans %}Compile minutes{% endtrans %}
            </button>
        </div>
    {% endif %}
{% endmacro %}


{% macro render_toggle_button(note, note_is_hidden) %}
    <div class="group i-selection note-visibility-toggle">
        {% set hash = uuid() %}
        <input type="checkbox" id="toggle-note-{{ note.id }}-{{ hash }}" {% if not note_is_hidden %}checked{% endif %}>
        <label for="toggle-note-{{ note.id }}-{{ hash }}" class="i-button icon-file js-show-note-toggle"
               title="">{% trans %}Minutes{% endtrans %}</label>
    </div>
{% endmacro %}


{% macro _togglable_classes(hidden) -%}
    togglable {% if hidden %}weak-hidden{% endif %}
{%- endmacro %}
